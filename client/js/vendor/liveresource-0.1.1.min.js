/*!
 * LiveResource library v0.1.1
 * (c) fanout - https://github.com/fanout/liveresource
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LiveResource=e()}}(function(){return function e(t,n,r){function i(u,a){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[u]={exports:{}};t[u][0].call(c.exports,function(e){var n=t[u][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,t,n){"use strict";t.exports=Pollymer},{}],2:[function(e,t,n){"use strict";t.exports=WebSockHop},{}],3:[function(e,t,n){function r(e,t){return h.isUndefined(t)?""+t:h.isNumber(t)&&!isFinite(t)?t.toString():h.isFunction(t)||h.isRegExp(t)?t.toString():t}function i(e,t){return h.isString(e)?e.length<t?e:e.slice(0,t):e}function o(e){return i(JSON.stringify(e.actual,r),128)+" "+e.operator+" "+i(JSON.stringify(e.expected,r),128)}function u(e,t,n,r,i){throw new g.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function a(e,t){e||u(e,!0,t,"==",g.ok)}function s(e,t){if(e===t)return!0;if(h.isBuffer(e)&&h.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return h.isDate(e)&&h.isDate(t)?e.getTime()===t.getTime():h.isRegExp(e)&&h.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:h.isObject(e)||h.isObject(t)?c(e,t):e==t}function l(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function c(e,t){if(h.isNullOrUndefined(e)||h.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(h.isPrimitive(e)||h.isPrimitive(t))return e===t;var n=l(e),r=l(t);if(n&&!r||!n&&r)return!1;if(n)return e=v.call(e),t=v.call(t),s(e,t);var i,o,u=d(e),a=d(t);if(u.length!=a.length)return!1;for(u.sort(),a.sort(),o=u.length-1;o>=0;o--)if(u[o]!=a[o])return!1;for(o=u.length-1;o>=0;o--)if(i=u[o],!s(e[i],t[i]))return!1;return!0}function f(e,t){return e&&t?"[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t?!0:t.call({},e)===!0?!0:!1:!1}function p(e,t,n,r){var i;h.isString(n)&&(r=n,n=null);try{t()}catch(o){i=o}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&u(i,n,"Missing expected exception"+r),!e&&f(i,n)&&u(i,n,"Got unwanted exception"+r),e&&i&&n&&!f(i,n)||!e&&i)throw i}var h=e("util/"),v=Array.prototype.slice,y=Object.prototype.hasOwnProperty,g=t.exports=a;g.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=o(this),this.generatedMessage=!0);var t=e.stackStartFunction||u;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=t.name,a=r.indexOf("\n"+i);if(a>=0){var s=r.indexOf("\n",a+1);r=r.substring(s+1)}this.stack=r}}},h.inherits(g.AssertionError,Error),g.fail=u,g.ok=a,g.equal=function(e,t,n){e!=t&&u(e,t,n,"==",g.equal)},g.notEqual=function(e,t,n){e==t&&u(e,t,n,"!=",g.notEqual)},g.deepEqual=function(e,t,n){s(e,t)||u(e,t,n,"deepEqual",g.deepEqual)},g.notDeepEqual=function(e,t,n){s(e,t)&&u(e,t,n,"notDeepEqual",g.notDeepEqual)},g.strictEqual=function(e,t,n){e!==t&&u(e,t,n,"===",g.strictEqual)},g.notStrictEqual=function(e,t,n){e===t&&u(e,t,n,"!==",g.notStrictEqual)},g["throws"]=function(e,t,n){p.apply(this,[!0].concat(v.call(arguments)))},g.doesNotThrow=function(e,t){p.apply(this,[!1].concat(v.call(arguments)))},g.ifError=function(e){if(e)throw e};var d=Object.keys||function(e){var t=[];for(var n in e)y.call(e,n)&&t.push(n);return t}},{"util/":9}],4:[function(e,t,n){(function(n){function r(){}function i(){p.log.apply(p,arguments)}function o(){p.log.apply(p,arguments)}function u(){p.warn.apply(p,arguments)}function a(e){d[e]=y()}function s(e){var t=d[e];if(!t)throw new Error("No such label: "+e);var n=y()-t;p.log(e+": "+n+"ms")}function l(){var e=new Error;e.name="Trace",e.message=h.format.apply(null,arguments),p.error(e.stack)}function c(e){p.log(h.inspect(e)+"\n")}function f(e){if(!e){var t=g.call(arguments,1);v.ok(!1,h.format.apply(null,t))}}var p,h=e("util"),v=e("assert"),y=e("date-now"),g=Array.prototype.slice,d={};p="undefined"!=typeof n&&n.console?n.console:"undefined"!=typeof window&&window.console?window.console:{};for(var b=[[r,"log"],[i,"info"],[o,"warn"],[u,"error"],[a,"time"],[s,"timeEnd"],[l,"trace"],[c,"dir"],[f,"assert"]],m=0;m<b.length;m++){var w=b[m],O=w[0],E=w[1];p[E]||(p[E]=O)}t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{assert:3,"date-now":5,util:9}],5:[function(e,t,n){function r(){return(new Date).getTime()}t.exports=r},{}],6:[function(e,t,n){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],7:[function(e,t,n){function r(){c=!1,a.length?l=a.concat(l):f=-1,l.length&&i()}function i(){if(!c){var e=setTimeout(r);c=!0;for(var t=l.length;t;){for(a=l,l=[];++f<t;)a[f].run();f=-1,t=l.length}a=null,c=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function u(){}var a,s=t.exports={},l=[],c=!1,f=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new o(e,t)),1!==l.length||c||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=u,s.addListener=u,s.once=u,s.off=u,s.removeListener=u,s.removeAllListeners=u,s.emit=u,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],8:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],9:[function(e,t,n){(function(t,r){function i(e,t){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(t)?r.showHidden=t:t&&n._extend(r,t),O(r.showHidden)&&(r.showHidden=!1),O(r.depth)&&(r.depth=2),O(r.colors)&&(r.colors=!1),O(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),s(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function u(e,t){return e}function a(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function s(e,t,r){if(e.customInspect&&t&&_(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return m(i)||(i=s(e,i,r)),i}var o=l(e,t);if(o)return o;var u=Object.keys(t),y=a(u);if(e.showHidden&&(u=Object.getOwnPropertyNames(t)),x(t)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return c(t);if(0===u.length){if(_(t)){var g=t.name?": "+t.name:"";return e.stylize("[Function"+g+"]","special")}if(E(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(U(t))return e.stylize(Date.prototype.toString.call(t),"date");if(x(t))return c(t)}var d="",b=!1,w=["{","}"];if(v(t)&&(b=!0,w=["[","]"]),_(t)){var O=t.name?": "+t.name:"";d=" [Function"+O+"]"}if(E(t)&&(d=" "+RegExp.prototype.toString.call(t)),U(t)&&(d=" "+Date.prototype.toUTCString.call(t)),x(t)&&(d=" "+c(t)),0===u.length&&(!b||0==t.length))return w[0]+d+w[1];if(0>r)return E(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var k;return k=b?f(e,t,r,y,u):u.map(function(n){return p(e,t,r,y,n,b)}),e.seen.pop(),h(k,d,w)}function l(e,t){if(O(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i){for(var o=[],u=0,a=t.length;a>u;++u)o.push(C(t,String(u))?p(e,t,n,r,String(u),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(e,t,n,r,i,!0))}),o}function p(e,t,n,r,i,o){var u,a,l;if(l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},l.get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),C(r,i)||(u="["+i+"]"),a||(e.seen.indexOf(l.value)<0?(a=g(n)?s(e,l.value,null):s(e,l.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),O(u)){if(o&&i.match(/^\d+$/))return a;u=JSON.stringify(""+i),u.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=e.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=e.stylize(u,"string"))}return u+": "+a}function h(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function v(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function g(e){return null===e}function d(e){return null==e}function b(e){return"number"==typeof e}function m(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function O(e){return void 0===e}function E(e){return k(e)&&"[object RegExp]"===S(e)}function k(e){return"object"==typeof e&&null!==e}function U(e){return k(e)&&"[object Date]"===S(e)}function x(e){return k(e)&&("[object Error]"===S(e)||e instanceof Error)}function _(e){return"function"==typeof e}function j(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function S(e){return Object.prototype.toString.call(e)}function W(e){return 10>e?"0"+e.toString(10):e.toString(10)}function P(){var e=new Date,t=[W(e.getHours()),W(e.getMinutes()),W(e.getSeconds())].join(":");return[e.getDate(),H[e.getMonth()],t].join(" ")}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var A=/%[sdj%]/g;n.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,u=String(e).replace(A,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),a=r[n];o>n;a=r[++n])u+=g(a)||!k(a)?" "+a:" "+i(a);return u},n.deprecate=function(e,i){function o(){if(!u){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),u=!0}return e.apply(this,arguments)}if(O(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(t.noDeprecation===!0)return e;var u=!1;return o};var R,T={};n.debuglog=function(e){if(O(R)&&(R=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!T[e])if(new RegExp("\\b"+e+"\\b","i").test(R)){var r=t.pid;T[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else T[e]=function(){};return T[e]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=v,n.isBoolean=y,n.isNull=g,n.isNullOrUndefined=d,n.isNumber=b,n.isString=m,n.isSymbol=w,n.isUndefined=O,n.isRegExp=E,n.isObject=k,n.isDate=U,n.isError=x,n.isFunction=_,n.isPrimitive=j,n.isBuffer=e("./support/isBuffer");var H=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",P(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!k(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":8,_process:7,inherits:6}],10:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("utils"),a=e("console"),s=(e("utils.mapWebSocketUrls"),e("ResourceHandling/ResourceHandler")),l=function(){function e(){r(this,e),this._resourceHandlers=new Map,this._engineUnits=[],this._updatePending=!1,this.options={longPollTimeoutMsecs:0,maxLongPollDelayMsecs:0}}return o(e,[{key:"setGlobalOptions",value:function(e){this.options=e}},{key:"getHandlerForUri",value:function(e){var t=this;return this._resourceHandlers.getOrCreate(e,function(){return new s(t,e)})}},{key:"getResourceAspectsForInterestType",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var u,a=this._resourceHandlers[Symbol.iterator]();!(n=(u=a.next()).done);n=!0){var s=i(u.value,2),l=(s[0],s[1]),c=l.getResourceAspectForInterestType(e);null!=c&&t.push(c)}}catch(f){r=!0,o=f}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw o}}return t}},{key:"update",value:function(){var e=this;this._updatePending||(this._updatePending=!0,n.nextTick(function(){e._updatePending=!1,a.info("engine: setup long polls");for(var t=0;t<e._engineUnits.length;t++){var n=e._engineUnits[t];n.update()}}))}},{key:"addEngineUnit",value:function(e){this._engineUnits.push(e),e.engine=this}},{key:"findEngineUnitForEvent",value:function(e){for(var t=0;t<this._engineUnits.length;t++){var n=this._engineUnits[t];if(u.findInArray(n.events,e)>=0)return n}return null}}]),e}();t.exports=l}).call(this,e("_process"))},{"ResourceHandling/ResourceHandler":24,_process:7,console:4,utils:27,"utils.mapWebSocketUrls":28}],11:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var i=e,o=t,u=n;a=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=u,r=!0}},s=e("utils"),l=e("console"),c=e("utils.parseLinkHeader"),f=e("EngineUnits/EngineUnitBase"),p=e("EngineUnits/Changes/ChangesResource"),h=e("EngineUnits/Changes/ChangesWaitConnection"),v=function(e){function t(){r(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._changesWaitConnections=new Map}return i(t,e),u(t,[{key:"update",value:function(){var e=this,t=this.engine.getResourceAspectsForInterestType(this.interestType),n=new Map,r=!0,i=!1,u=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.changesWaitUri&&n.set(l.changesWaitUri,l)}}catch(c){i=!0,u=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw u}}var f=new Map,p=!0,v=!1,y=void 0;try{for(var g,d=n[Symbol.iterator]();!(p=(g=d.next()).done);p=!0){var b=o(g.value,2),m=b[0],w=b[1];f.set(m,{endpointUri:m,item:w})}}catch(c){v=!0,y=c}finally{try{!p&&d["return"]&&d["return"]()}finally{if(v)throw y}}this._adjustEndpoints("Changes Wait",this._changesWaitConnections,f,function(t){return new h(e,t)})}},{key:"start",value:function(e){var t=this,n=new p(e),r=this.createLongPoll();return r.on("finished",function(e,i,o){e>=200&&300>e?(t.updateResource(n,o,i),n.changesWaitUri||l.info("no changes-wait link"),t.updateEngine(),r=null):e>=400&&r.retry()}),r.start("HEAD",e.uri),n}},{key:"updateResource",value:function(e,n,r){var i=t.parseHeaders(n,e.resourceHandler.uri);if(i.changesWaitUri){var o=this._changesWaitConnections.get(e.changesWaitUri);o&&this._changesWaitConnections["delete"](e.changesWaitUri),e.changesWaitUri=i.changesWaitUri,o&&(this._changesWaitConnections.set(e.changesWaitUri,o),o.uri=e.changesWaitUri)}a(Object.getPrototypeOf(t.prototype),"updateResource",this).call(this,e,n,r)}},{key:"triggerEvents",value:function(e,t){e.started||(e.started=!0,e.resourceHandler.triggerOnceOnlyEvent("ready",e.resourceHandler));for(var n=0;n<t.length;++n)t[n].deleted?e.resourceHandler.trigger("child-deleted",e.resourceHandler,t[n]):e.resourceHandler.trigger("child-added",e.resourceHandler,t[n])}},{key:"interestType",get:function(){return"changes"}},{key:"events",get:function(){return["child-added","child-removed"]}}],[{key:"parseHeaders",value:function(e,t){var n=null;s.forEachOwnKeyValue(e,function(e,r){var i=e.toLowerCase();if("link"==i){var o=c(r);o&&o["changes-wait"]&&(n=s.toAbsoluteUri(t,o["changes-wait"].href))}});var r={};return n&&(l.info("changes-wait: ["+n+"]"),r.changesWaitUri=n),r}}]),t}(f);t.exports=v},{"EngineUnits/Changes/ChangesResource":12,"EngineUnits/Changes/ChangesWaitConnection":13,"EngineUnits/EngineUnitBase":15,console:4,utils:27,"utils.parseLinkHeader":29}],12:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(e,t,n){for(var r=!0;r;){var i=e,o=t,u=n;a=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=u,r=!0}},u=e("EngineUnits/ResourceBase"),a=function(e){function t(e){r(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.started=!1,this.changesWaitUri=null}return i(t,e),t}(u);t.exports=a},{"EngineUnits/ResourceBase":16}],13:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var i=e,o=t,u=n;a=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=u,r=!0}},a=(e("utils"),e("console")),s=e("EngineUnits/ConnectionBase"),l=function(e){function t(e,n){var i=this;r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.uri=n.endpointUri,this.request=e.createLongPoll(),this.res=n.item,this.isActive=!1,this.request.on("finished",function(t,n,r){i.isActive=!1,t>=200&&300>t&&e.updateResource(i.res,r,n),i._engineUnit.updateEngine()})}return i(t,e),o(t,[{key:"hasChanged",value:function(e){return this.res.resourceHandler.uri!=e.item.resourceHandler.uri}},{key:"abort",value:function(){this.request.abort()}},{key:"refresh",value:function(e){if(!this.isActive){var t=this.uri;a.info("Changes Wait Request URI: "+t),this._engineUnit.setLongPollOptions(this.request),this.request.start("GET",t,{Wait:55}),this.isActive=!0}}}]),t}(s);t.exports=l},{"EngineUnits/ConnectionBase":14,console:4,utils:27}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){r(this,e),this._engineUnit=t}return i(e,[{key:"hasChanged",value:function(e){throw!1}},{key:"abort",value:function(){}},{key:"refresh",value:function(e){}}]),e}();t.exports=o},{}],15:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=(e("utils"),e("console")),a=e("Pollymer"),s=function(){function e(){r(this,e),this.engine=null}return o(e,[{key:"update",value:function(){}},{key:"updateEngine",value:function(){this.engine.update()}},{key:"start",value:function(e){return null}},{key:"updateResources",value:function(e,t,n){var r=this.engine.getHandlerForUri(e),i=r.getResourceAspectForInterestType(this.interestType);null!=i&&this.updateResource(i,t,n)}},{key:"updateResource",value:function(e,t,n){this.triggerEvents(e,n)}},{key:"triggerEvents",value:function(e,t){}},{key:"createLongPoll",value:function(){var e=new a.Request;return this.setLongPollOptions(e),e}},{key:"setLongPollOptions",value:function(e){e.timeout=this.engine.options.longPollTimeoutMsecs?this.engine.options.longPollTimeoutMsecs:6e4,e.maxDelay=this.engine.options.maxLongPollDelayMsecs?this.engine.options.maxLongPollDelayMsecs:1e3}},{key:"_adjustEndpoints",value:function(e,t,n,r){var o=new Map,a=!0,s=!1,l=void 0;try{for(var c,f=n[Symbol.iterator]();!(a=(c=f.next()).done);a=!0){var p=i(c.value,2),h=p[0],v=p[1];o.set(h,v)}}catch(y){s=!0,l=y}finally{try{!a&&f["return"]&&f["return"]()}finally{if(s)throw l}}var g=[],d=!0,b=!1,m=void 0;try{for(var w,O=t[Symbol.iterator]();!(d=(w=O.next()).done);d=!0){var E=i(w.value,2),k=E[0],U=E[1];o["delete"](k);var x=!1;if(n.has(k)){var _=n.get(k);x=U.hasChanged(_)}else x=!0;x&&g.push(k)}}catch(y){b=!0,m=y}finally{try{!d&&O["return"]&&O["return"]()}finally{if(b)throw m}}for(var j=0;j<g.length;j++){var S=g[j];u.info("Remove '"+e+"' endpoint - '"+S+"'.");var W=t.get(S);W.abort(),t["delete"](S)}var P=!0,C=!1,A=void 0;try{for(var R,T=o[Symbol.iterator]();!(P=(R=T.next()).done);P=!0){var H=i(R.value,2),M=H[0],I=H[1];u.info("Adding '"+e+"' endpoint - '"+M+"'."),t.set(M,r(I))}}catch(y){C=!0,A=y}finally{try{!P&&T["return"]&&T["return"]()}finally{if(C)throw A}}var q=!0,L=!1,F=void 0;try{for(var D,V=t[Symbol.iterator]();!(q=(D=V.next()).done);q=!0){var B=i(D.value,2),z=B[0],N=B[1],_=n.get(z);N.refresh(_)}}catch(y){L=!0,F=y}finally{try{!q&&V["return"]&&V["return"]()}finally{if(L)throw F}}}},{key:"interestType",get:function(){return null}},{key:"events",get:function(){return null}}],[{key:"parseHeaders",value:function(e,t){}}]),e}();t.exports=s},{Pollymer:1,console:4,utils:27}],16:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function o(e){r(this,o),this.resourceHandler=e};t.exports=i},{}],17:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var i=e,o=t,u=n;a=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=u,r=!0}},s=e("utils"),l=e("console"),c=(e("EngineUnits/Value/ValueResource"),e("EngineUnits/ConnectionBase")),f=function(e){function t(e,n){var i=this;r(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.uri=n.endpointUri,this.request=e.createLongPoll(),this.resItems=n.items.slice(),this.isActive=!1,this.request.on("finished",function(t,n,r){if(i.isActive=!1,t>=200&&300>t){var u=!0,a=!1,c=void 0;try{for(var f,p=s.objectEntries(n)[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=o(f.value,2),v=h[0],y=h[1];l.info("got data for uri: "+v);var g=s.toAbsoluteUri(i.uri,v);e.updateResources(g,y.headers,y.body)}}catch(d){a=!0,c=d}finally{try{!u&&p["return"]&&p["return"]()}finally{if(a)throw c}}}i._engineUnit.updateEngine()})}return i(t,e),u(t,[{key:"hasChanged",value:function(e){var t=!1;if(e.items.length!=this.resItems.length)t=!0;else{var n,r=[];for(n=0;n<e.items.length;n++)r.push(e.items[n].resourceHandler.uri);r.sort();var i=[];for(n=0;n<this.resItems.length;n++)i.push(this.resItems[n].resourceHandler.uri);for(i.sort(),n=0;n<r.length;n++)if(r[n]!=i[n]){t=!0;break}}return t}},{key:"abort",value:function(){this.request.abort()}},{key:"refresh",value:function(e){if(!this.isActive){for(var t=[],n=0;n<this.resItems.length;n++){var r=this.resItems[n],i=r.resourceHandler.uri;t.push("u="+encodeURIComponent(i)+"&inm="+encodeURIComponent(r.etag))}var o=this.uri+"?"+t.join("&");l.info("Multiplex Wait Request URI: "+o),this._engineUnit.setLongPollOptions(this.request),this.request.start("GET",o,{Wait:55}),this.isActive=!0}}}]),t}(c);t.exports=f},{"EngineUnits/ConnectionBase":14,"EngineUnits/Value/ValueResource":20,console:4,utils:27}],18:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var i=e,o=t,u=n;a=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=u,r=!0}},s=e("utils"),l=e("console"),c=e("utils.mapWebSocketUrls"),f=e("WebSockHop"),p=e("EngineUnits/ConnectionBase"),h=(e("EngineUnits/Value/ValueResource"),function(e){function t(e,n){var i=this;r(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var o=n.endpointUri;this.uri=o,this.socket=new f(o),this.subscribedItems={},this.isConnected=!1,this.isRetrying=!1,this.socket.formatter=new f.JsonFormatter,this.socket.on("opened",function(){i.socket.on("message",function(t){var n=t.uri,r=s.toAbsoluteUri(o,n),i=c.mapWebSocketUrlToHttpUrl(r);e.updateResources(i,t.headers,t.body)}),i.subscribedItems={},i.isConnected=!0,i.isRetrying=!1,i._engineUnit.updateEngine()}),this.socket.on("closed",function(){i.isConnected=!1,i.isRetrying=!1}),this.socket.on("error",function(){i.isConnected=!1,i.isRetrying=!0})}return i(t,e),u(t,[{key:"subscribe",value:function(e){var t=this,n="subscribe",r="value";this.socket.request({type:n,mode:r,uri:e},function(n){"subscribed"==n.type&&(t.subscribedItems[e]=e)})}},{key:"unsubscribe",value:function(e){var t=this,n="unsubscribe",r="value";this.socket.request({type:n,mode:r,uri:e},function(n){"unsubscribed"==n.type&&delete t.subscribedItems[e]})}},{key:"mapToHttpUri",value:function(e){var t=s.toAbsoluteUri(this.uri,e);return c.mapWebSocketUrlToHttpUrl(t)}},{key:"checkSubscriptions",value:function(e){var t=this.uri;l.info("Multiplex WebSocket Request URI: "+t);var n={},r=!0,i=!1,u=void 0;try{for(var a,c=s.objectEntries(this.subscribedItems)[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var f=o(a.value,2),p=f[0],h=f[1];n[p]=h}}catch(v){i=!0,u=v}finally{try{!r&&c["return"]&&c["return"]();

}finally{if(i)throw u}}for(var y=0;y<e.length;y++){var g=this.mapToHttpUri(e[y].resourceHandler.uri);g in n?delete n[g]:this.subscribe(g)}var d=!0,b=!1,m=void 0;try{for(var w,O=s.objectEntries(n)[Symbol.iterator]();!(d=(w=O.next()).done);d=!0){var E=o(w.value,2),p=E[0],h=E[1];this.unsubscribe(p)}}catch(v){b=!0,m=v}finally{try{!d&&O["return"]&&O["return"]()}finally{if(b)throw m}}}},{key:"close",value:function(){this.isConnected?this.socket.close():this.socket.abort()}},{key:"hasChanged",value:function(e){return 0==e.items.length}},{key:"abort",value:function(){this.socket.abort()}},{key:"refresh",value:function(e){this.isConnected&&this.checkSubscriptions(e.items)}}],[{key:"isWebSockHopAvailable",get:function(){return f.isAvailable()}}]),t}(p));t.exports=h},{"EngineUnits/ConnectionBase":14,"EngineUnits/Value/ValueResource":20,WebSockHop:2,console:4,utils:27,"utils.mapWebSocketUrls":28}],19:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var i=e,o=t,u=n;a=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=u,r=!0}},s=e("utils"),l=e("console"),c=e("utils.mapWebSocketUrls"),f=e("utils.parseLinkHeader"),p=e("EngineUnits/EngineUnitBase"),h=e("EngineUnits/Value/ValueResource"),v=e("EngineUnits/Value/ValueWaitConnection"),y=e("EngineUnits/Value/MultiplexWebSocketConnection"),g=e("EngineUnits/Value/MultiplexWaitConnection"),d=function(e){function t(){r(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._valueWaitConnections=new Map,this._multiplexWebSocketConnections=new Map,this._multiplexWaitConnections=new Map}return i(t,e),u(t,[{key:"update",value:function(){var e=this,t=this.engine.getResourceAspectsForInterestType(this.interestType),n=new Map,r=new Map,i=new Map,u=!0,a=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(u=(l=c.next()).done);u=!0){var f=l.value;if(y.isWebSockHopAvailable&&f.multiplexWebSocketUri){var p=r.getOrCreate(f.multiplexWebSocketUri,function(){return{items:[]}});p.items.push(f)}else if(f.multiplexWaitUri){var h=i.getOrCreate(f.multiplexWaitUri,function(){return{items:[]}});h.items.push(f)}else n.set(f.valueWaitUri,f)}}catch(d){a=!0,s=d}finally{try{!u&&c["return"]&&c["return"]()}finally{if(a)throw s}}var b=new Map,m=new Map,w=new Map,O=!0,E=!1,k=void 0;try{for(var U,x=r[Symbol.iterator]();!(O=(U=x.next()).done);O=!0){var _=o(U.value,2),j=_[0],S=_[1];m.set(j,{endpointUri:j,items:S.items})}}catch(d){E=!0,k=d}finally{try{!O&&x["return"]&&x["return"]()}finally{if(E)throw k}}var W=!0,P=!1,C=void 0;try{for(var A,R=i[Symbol.iterator]();!(W=(A=R.next()).done);W=!0){var T=o(A.value,2),j=T[0],S=T[1];S.items.length>1||!S.items[0].valueWaitUri?w.set(j,{endpointUri:j,items:S.items}):n.set(S.items[0].valueWaitUri,S.items[0])}}catch(d){P=!0,C=d}finally{try{!W&&R["return"]&&R["return"]()}finally{if(P)throw C}}var H=!0,M=!1,I=void 0;try{for(var q,L=n[Symbol.iterator]();!(H=(q=L.next()).done);H=!0){var F=o(q.value,2),j=F[0],S=F[1];b.set(j,{endpointUri:j,item:S})}}catch(d){M=!0,I=d}finally{try{!H&&L["return"]&&L["return"]()}finally{if(M)throw I}}this._adjustEndpoints("Value Wait",this._valueWaitConnections,b,function(t){return new v(e,t)}),this._adjustEndpoints("Multiplex Web Socket",this._multiplexWebSocketConnections,m,function(t){return new y(e,t)}),this._adjustEndpoints("Multiplex Wait",this._multiplexWaitConnections,w,function(t){return new g(e,t)})}},{key:"start",value:function(e){var t=this,n=new h(e),r=this.createLongPoll();return r.on("finished",function(i,o,u){i>=200&&400>i?(t.updateResource(n,u,300>i?o:null),n.etag||l.info("no etag"),t.updateEngine(),r=null):i>=400&&(404==i?(e.trigger("removed",e),r=null):r.retry())}),r.start("GET",e.uri),n}},{key:"updateResource",value:function(e,n,r){var i=t.parseHeaders(n,e.resourceHandler.uri);i.etag&&(e.etag=i.etag),i.valueWaitUri&&(e.valueWaitUri=i.valueWaitUri),i.multiplexWaitUri&&(e.multiplexWaitUri=i.multiplexWaitUri),i.multiplexWsUri&&(e.multiplexWebSocketUri=i.multiplexWsUri),a(Object.getPrototypeOf(t.prototype),"updateResource",this).call(this,e,n,r)}},{key:"triggerEvents",value:function(e,t){void 0!=t&&e.resourceHandler.trigger("value",e.resourceHandler,t)}},{key:"interestType",get:function(){return"value"}},{key:"events",get:function(){return["value","removed"]}}],[{key:"parseHeaders",value:function(e,t){var n=null,r=null,i=null,o=null;s.forEachOwnKeyValue(e,function(e,u){var a=e.toLowerCase();if("etag"==a)n=u;else if("link"==a){var l=f(u);l&&l["value-wait"]&&(r=s.toAbsoluteUri(t,l["value-wait"].href)),l&&l["multiplex-wait"]&&(i=s.toAbsoluteUri(t,l["multiplex-wait"].href)),l&&l["multiplex-ws"]&&(o=c.mapHttpUrlToWebSocketUrl(s.toAbsoluteUri(t,l["multiplex-ws"].href)))}});var u={};return n&&(l.info("etag: ["+n+"]"),u.etag=n),r&&(l.info("value-wait: ["+r+"]"),u.valueWaitUri=r),i&&(l.info("multiplex-wait: ["+i+"]"),u.multiplexWaitUri=i),o&&(l.info("multiplex-ws: ["+o+"]"),u.multiplexWsUri=o),u}}]),t}(p);t.exports=d},{"EngineUnits/EngineUnitBase":15,"EngineUnits/Value/MultiplexWaitConnection":17,"EngineUnits/Value/MultiplexWebSocketConnection":18,"EngineUnits/Value/ValueResource":20,"EngineUnits/Value/ValueWaitConnection":21,console:4,utils:27,"utils.mapWebSocketUrls":28,"utils.parseLinkHeader":29}],20:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(e,t,n){for(var r=!0;r;){var i=e,o=t,u=n;a=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=u,r=!0}},u=e("EngineUnits/ResourceBase"),a=function(e){function t(e){r(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.started=!1,this.etag=null,this.valueWaitUri=null,this.multiplexWaitUri=null,this.multiplexWebSocketUri=null}return i(t,e),t}(u);t.exports=a},{"EngineUnits/ResourceBase":16}],21:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var i=e,o=t,u=n;a=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=u,r=!0}},a=(e("utils"),e("console")),s=e("EngineUnits/ConnectionBase"),l=function(e){function t(e,n){var i=this;r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.uri=n.endpointUri,this.request=e.createLongPoll(),this.res=n.item,this.isActive=!1,this.request.on("finished",function(t,n,r){i.isActive=!1,t>=200&&300>t&&e.updateResource(i.res,r,n),i._engineUnit.updateEngine()})}return i(t,e),o(t,[{key:"hasChanged",value:function(e){return this.res.resourceHandler.uri!=e.item.resourceHandler.uri}},{key:"abort",value:function(){this.request.abort()}},{key:"refresh",value:function(e){if(!this.isActive){var t=this.uri;a.info("Value Wait Request URI: "+t),this._engineUnit.setLongPollOptions(this.request),this.request.start("GET",t,{"If-None-Match":this.res.etag,Wait:55}),this.isActive=!0}}}]),t}(s);t.exports=l},{"EngineUnits/ConnectionBase":14,console:4,utils:27}],22:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("utils"),u=(e("console"),function(){function e(){r(this,e),this._events={}}return i(e,[{key:"_getHandlersForType",value:function(e){return e in this._events||(this._events[e]=[]),this._events[e]}},{key:"on",value:function(e,t){var n=this._getHandlersForType(e);n.push(t)}},{key:"off",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(null!=t){var n=this._getHandlersForType(e);o.removeFromArray(n,t)}else delete this._events[e]}},{key:"trigger",value:function(e,t){for(var n=this._getHandlersForType(e).slice(),r=arguments.length,i=Array(r>2?r-2:0),o=2;r>o;o++)i[o-2]=arguments[o];for(var u=0,a=n.length;a>u;u++){var s=n[u];s.apply(t,i)}}}]),e}());t.exports=u},{console:4,utils:27}],23:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("utils"),u=e("utils.getWindowLocationHref"),a=e("ResourceHandling/Events"),s=function(){function e(t,n,i){r(this,e),this._events=new a,n.setGlobalOptions(t.options);var s=u(),l=o.toAbsoluteUri(s,i);this._resourceHandler=n.getHandlerForUri(l),this._resourceHandler.addLiveResource(this)}return i(e,[{key:"on",value:function(e,t){this._events.on(e,t),this._resourceHandler.addEvent(e)}},{key:"off",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];this._events.off(e,t)}},{key:"cancel",value:function(){this._events=null,null!=this._resourceHandler&&(this._resourceHandler.removeLiveResource(this),this._resourceHandler=null)}}],[{key:"createLiveResourceConstructorWithEngine",value:function(t){var n=function i(n){return r(this,i),new e(this.constructor,t,n)};return n.options={longPollTimeoutMsecs:0,maxLongPollDelayMsecs:0},n}}]),e}();t.exports=s},{"ResourceHandling/Events":22,utils:27,"utils.getWindowLocationHref":26}],24:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("utils"),a=e("console"),s=function(){function e(t,n){i(this,e),this._engine=t,this.uri=n,this._resourceAspects={},this._liveResources=[],this._onceOnlyEventMap=new WeakMap,this._onceOnlyEvents=new Map}return o(e,[{key:"addLiveResource",value:function(e){this._liveResources.push(e),this._onceOnlyEventMap.set(e,[])}},{key:"removeLiveResource",value:function(e){u.removeFromArray(this._liveResources,e)}},{key:"trigger",value:function(e,t){for(var n=this._liveResources.length,r=arguments.length,i=Array(r>2?r-2:0),o=2;r>o;o++)i[o-2]=arguments[o];for(var u=0;n>u;u++){var a,s=this._liveResources[u];(a=s._events).trigger.apply(a,[e,t].concat(i))}}},{key:"triggerOnceOnlyEvent",value:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;n>i;i++)r[i-2]=arguments[i];this._onceOnlyEvents.set(e,{target:t,args:r}),this.checkOnceOnlyEvents()}},{key:"checkOnceOnlyEvents",value:function(){a.log("Checking once only events...");var e=!0,t=!1,n=void 0;try{for(var i,o=this._onceOnlyEvents.keys()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var u=i.value,s=this._onceOnlyEvents.get(u),l=s.target,c=s.args,f=!0,p=!1,h=void 0;try{for(var v,y=this._liveResources[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var g=v.value,d=this._onceOnlyEventMap.get(g);if(d.indexOf(u)<0){var b;d.push(u),(b=g._events).trigger.apply(b,[u,l].concat(r(c)))}}}catch(m){p=!0,h=m}finally{try{!f&&y["return"]&&y["return"]()}finally{if(p)throw h}}}}catch(m){t=!0,n=m}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw n}}}},{key:"addEvent",value:function(e){var t=this._engine.findEngineUnitForEvent(e),n=null!=t?t.interestType:null;null==n||n in this._resourceAspects||(this._resourceAspects[n]=t.start(this)),this.checkOnceOnlyEvents()}},{key:"getResourceAspectForInterestType",value:function(e){return null!=e&&e in this._resourceAspects?this._resourceAspects[e]:null}}]),e}();t.exports=s},{console:4,utils:27}],25:[function(e,t,n){"use strict";var r=e("Engine/Engine"),i=new r,o=e("EngineUnits/Value/ValueEngineUnit");i.addEngineUnit(new o);var u=e("EngineUnits/Changes/ChangesEngineUnit");i.addEngineUnit(new u);var a=e("ResourceHandling/LiveResource"),s=a.createLiveResourceConstructorWithEngine(i);t.exports=s},{"Engine/Engine":10,"EngineUnits/Changes/ChangesEngineUnit":11,"EngineUnits/Value/ValueEngineUnit":19,"ResourceHandling/LiveResource":23}],26:[function(e,t,n){"use strict";var r=function(){return window.location.href};t.exports=r},{}],27:[function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1},o=function(e,t){return!(i(e,t)<0)},u=function(e,t){for(var n=!0;n;){var r=utils.findInArray(e,t);-1!=r?e.splice(r,1):n=!1}},a=function(e){var t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null},s=function(e,t){function n(e){var t=[];return e.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(e){"/.."===e?t.pop():t.push(e)}),t.join("").replace(/^\//,"/"===e.charAt(0)?"/":"")}return t=a(t||""),e=a(e||""),t&&e?(t.protocol||e.protocol)+(t.protocol||t.authority?t.authority:e.authority)+n(t.protocol||t.authority||"/"===t.pathname.charAt(0)?t.pathname:t.pathname?(e.authority&&!e.pathname?"/":"")+e.pathname.slice(0,e.pathname.lastIndexOf("/")+1)+t.pathname:e.pathname)+(t.protocol||t.authority||t.pathname?t.search:t.search||e.search)+t.hash:null},l=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var r=t(n,e[n]);if("undefined"!=typeof r&&!r)break}},c=function(e,t){return e.substring(0,t.length)==t},f=function(e,t,n){return n+e.substring(t.length)},p=function(e){var t,n=0,i=[];for(var o in e)e.hasOwnProperty(o)&&i.push(o);return t={},r(t,Symbol.iterator,function(){return this}),r(t,"next",function(){if(n<i.length){var t=i[n];return n++,{value:[t,e[t]]}}return{done:!0}}),t};t.exports={findInArray:i,isInArray:o,removeFromArray:u,toAbsoluteUri:s,forEachOwnKeyValue:l,objectEntries:p,beginsWith:c,replaceStart:f},Map.prototype.getOrCreate=function(e,t){var n=void 0;return this.has(e)?n=this.get(e):(n=t(),this.set(e,n)),n}},{}],28:[function(e,t,n){"use strict";var r=e("utils"),i=e("utils.getWindowLocationHref");t.exports={mapHttpUrlToWebSocketUrl:function(e){var t=i(),n=r.toAbsoluteUri(t,e),o=n;if(r.beginsWith(n,"http://")?o=r.replaceStart(n,"http://","ws://"):r.beginsWith(n,"https://")&&(o=r.replaceStart(n,"https://","wss://")),!r.beginsWith(o,"ws://")&&!r.beginsWith(o,"wss://"))throw"not valid";return o},mapWebSocketUrlToHttpUrl:function(e){var t=e;if(r.beginsWith(e,"ws://")?t=r.replaceStart(e,"ws://","http://"):r.beginsWith(e,"wss://")&&(t=r.replaceStart(e,"wss://","https://")),!r.beginsWith(t,"http://")&&!r.beginsWith(t,"https://"))throw"not valid";return t}}},{utils:27,"utils.getWindowLocationHref":26}],29:[function(e,t,n){"use strict";var r=e("console");t.exports=function(e){if(0==e.length)return null;for(var t={},n=0,i=!0;i;){for(;n<e.length&&" "==e[n];++n);if(n>=e.length||"<"!=e[n])return null;var o=n+1,u=e.indexOf(">",n);if(-1==u)return null;var a=e.substring(o,u);n=u+1,i=!1;var s=!1;if(n<e.length)if(","==e[n])i=!0,++n;else{if(";"!=e[n])return null;s=!0,++n}for(var l=null,c={};s;){for(;n<e.length&&" "==e[n];++n);if(n>=e.length)return null;for(o=n;n<e.length&&("="!=e[n]&&","!=e[n]&&";"!=e[n]);++n);u=n;var f=e.substring(o,u),p=null;if(n<e.length&&"="==e[n])if(++n,n<e.length&&'"'==e[n]){if(o=n+1,n=e.indexOf('"',o),-1==n)return null;u=n,p=e.substring(o,u),++n}else{for(o=n;n<e.length&&(","!=e[n]&&";"!=e[n]);++n);u=n,p=e.substring(o,u)}if(s=!1,n<e.length)if(","==e[n])i=!0,++n;else{if(";"!=e[n])return null;s=!0,++n}"rel"==f?l=p:c[f]=p}if(l)for(var h=l.split(" "),v=0;v<h.length;++v){r.info("link: url=["+a+"], rel=["+h[v]+"]");var y={};y.rel=h[v],y.href=a;for(var g in c)c.hasOwnProperty(g)&&(y[g]=c[g]);t[y.rel]=y}}return t}},{console:4}]},{},[25])(25)});