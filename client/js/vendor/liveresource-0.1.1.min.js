/*!
 * LiveResource library v0.1.1
 * (c) fanout - https://github.com/fanout/liveresource
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LiveResource=e()}}(function(){return function e(t,n,r){function o(u,a){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){"use strict";t.exports=Pollymer},{}],2:[function(e,t,n){"use strict";t.exports=WebSockHop},{}],3:[function(e,t,n){function r(e,t){return v.isUndefined(t)?""+t:v.isNumber(t)&&!isFinite(t)?t.toString():v.isFunction(t)||v.isRegExp(t)?t.toString():t}function o(e,t){return v.isString(e)?e.length<t?e:e.slice(0,t):e}function i(e){return o(JSON.stringify(e.actual,r),128)+" "+e.operator+" "+o(JSON.stringify(e.expected,r),128)}function u(e,t,n,r,o){throw new y.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:o})}function a(e,t){e||u(e,!0,t,"==",y.ok)}function s(e,t){if(e===t)return!0;if(v.isBuffer(e)&&v.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return v.isDate(e)&&v.isDate(t)?e.getTime()===t.getTime():v.isRegExp(e)&&v.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:v.isObject(e)||v.isObject(t)?l(e,t):e==t}function c(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function l(e,t){if(v.isNullOrUndefined(e)||v.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(v.isPrimitive(e)||v.isPrimitive(t))return e===t;var n=c(e),r=c(t);if(n&&!r||!n&&r)return!1;if(n)return e=h.call(e),t=h.call(t),s(e,t);var o,i,u=d(e),a=d(t);if(u.length!=a.length)return!1;for(u.sort(),a.sort(),i=u.length-1;i>=0;i--)if(u[i]!=a[i])return!1;for(i=u.length-1;i>=0;i--)if(o=u[i],!s(e[o],t[o]))return!1;return!0}function f(e,t){return e&&t?"[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t?!0:t.call({},e)===!0?!0:!1:!1}function p(e,t,n,r){var o;v.isString(n)&&(r=n,n=null);try{t()}catch(i){o=i}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!o&&u(o,n,"Missing expected exception"+r),!e&&f(o,n)&&u(o,n,"Got unwanted exception"+r),e&&o&&n&&!f(o,n)||!e&&o)throw o}var v=e("util/"),h=Array.prototype.slice,g=Object.prototype.hasOwnProperty,y=t.exports=a;y.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=i(this),this.generatedMessage=!0);var t=e.stackStartFunction||u;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,o=t.name,a=r.indexOf("\n"+o);if(a>=0){var s=r.indexOf("\n",a+1);r=r.substring(s+1)}this.stack=r}}},v.inherits(y.AssertionError,Error),y.fail=u,y.ok=a,y.equal=function(e,t,n){e!=t&&u(e,t,n,"==",y.equal)},y.notEqual=function(e,t,n){e==t&&u(e,t,n,"!=",y.notEqual)},y.deepEqual=function(e,t,n){s(e,t)||u(e,t,n,"deepEqual",y.deepEqual)},y.notDeepEqual=function(e,t,n){s(e,t)&&u(e,t,n,"notDeepEqual",y.notDeepEqual)},y.strictEqual=function(e,t,n){e!==t&&u(e,t,n,"===",y.strictEqual)},y.notStrictEqual=function(e,t,n){e===t&&u(e,t,n,"!==",y.notStrictEqual)},y["throws"]=function(e,t,n){p.apply(this,[!0].concat(h.call(arguments)))},y.doesNotThrow=function(e,t){p.apply(this,[!1].concat(h.call(arguments)))},y.ifError=function(e){if(e)throw e};var d=Object.keys||function(e){var t=[];for(var n in e)g.call(e,n)&&t.push(n);return t}},{"util/":9}],4:[function(e,t,n){(function(n){function r(){}function o(){p.log.apply(p,arguments)}function i(){p.log.apply(p,arguments)}function u(){p.warn.apply(p,arguments)}function a(e){d[e]=g()}function s(e){var t=d[e];if(!t)throw new Error("No such label: "+e);var n=g()-t;p.log(e+": "+n+"ms")}function c(){var e=new Error;e.name="Trace",e.message=v.format.apply(null,arguments),p.error(e.stack)}function l(e){p.log(v.inspect(e)+"\n")}function f(e){if(!e){var t=y.call(arguments,1);h.ok(!1,v.format.apply(null,t))}}var p,v=e("util"),h=e("assert"),g=e("date-now"),y=Array.prototype.slice,d={};p="undefined"!=typeof n&&n.console?n.console:"undefined"!=typeof window&&window.console?window.console:{};for(var b=[[r,"log"],[o,"info"],[i,"warn"],[u,"error"],[a,"time"],[s,"timeEnd"],[c,"trace"],[l,"dir"],[f,"assert"]],m=0;m<b.length;m++){var w=b[m],O=w[0],E=w[1];p[E]||(p[E]=O)}t.exports=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{assert:3,"date-now":5,util:9}],5:[function(e,t,n){function r(){return(new Date).getTime()}t.exports=r},{}],6:[function(e,t,n){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],7:[function(e,t,n){function r(){l=!1,a.length?c=a.concat(c):f=-1,c.length&&o()}function o(){if(!l){var e=setTimeout(r);l=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;)a[f].run();f=-1,t=c.length}a=null,l=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function u(){}var a,s=t.exports={},c=[],l=!1,f=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new i(e,t)),1!==c.length||l||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=u,s.addListener=u,s.once=u,s.off=u,s.removeListener=u,s.removeAllListeners=u,s.emit=u,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],8:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],9:[function(e,t,n){(function(t,r){function o(e,t){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(t)?r.showHidden=t:t&&n._extend(r,t),O(r.showHidden)&&(r.showHidden=!1),O(r.depth)&&(r.depth=2),O(r.colors)&&(r.colors=!1),O(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),s(r,e,r.depth)}function i(e,t){var n=o.styles[t];return n?"["+o.colors[n][0]+"m"+e+"["+o.colors[n][1]+"m":e}function u(e,t){return e}function a(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function s(e,t,r){if(e.customInspect&&t&&C(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(r,e);return m(o)||(o=s(e,o,r)),o}var i=c(e,t);if(i)return i;var u=Object.keys(t),g=a(u);if(e.showHidden&&(u=Object.getOwnPropertyNames(t)),j(t)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return l(t);if(0===u.length){if(C(t)){var y=t.name?": "+t.name:"";return e.stylize("[Function"+y+"]","special")}if(E(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(_(t))return e.stylize(Date.prototype.toString.call(t),"date");if(j(t))return l(t)}var d="",b=!1,w=["{","}"];if(h(t)&&(b=!0,w=["[","]"]),C(t)){var O=t.name?": "+t.name:"";d=" [Function"+O+"]"}if(E(t)&&(d=" "+RegExp.prototype.toString.call(t)),_(t)&&(d=" "+Date.prototype.toUTCString.call(t)),j(t)&&(d=" "+l(t)),0===u.length&&(!b||0==t.length))return w[0]+d+w[1];if(0>r)return E(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var k;return k=b?f(e,t,r,g,u):u.map(function(n){return p(e,t,r,g,n,b)}),e.seen.pop(),v(k,d,w)}function c(e,t){if(O(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,o){for(var i=[],u=0,a=t.length;a>u;++u)i.push(H(t,String(u))?p(e,t,n,r,String(u),!0):"");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(e,t,n,r,o,!0))}),i}function p(e,t,n,r,o,i){var u,a,c;if(c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},c.get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),H(r,o)||(u="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=y(n)?s(e,c.value,null):s(e,c.value,n-1),a.indexOf("\n")>-1&&(a=i?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),O(u)){if(i&&o.match(/^\d+$/))return a;u=JSON.stringify(""+o),u.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(u=u.substr(1,u.length-2),u=e.stylize(u,"name")):(u=u.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),u=e.stylize(u,"string"))}return u+": "+a}function v(e,t,n){var r=0,o=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function h(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function y(e){return null===e}function d(e){return null==e}function b(e){return"number"==typeof e}function m(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function O(e){return void 0===e}function E(e){return k(e)&&"[object RegExp]"===P(e)}function k(e){return"object"==typeof e&&null!==e}function _(e){return k(e)&&"[object Date]"===P(e)}function j(e){return k(e)&&("[object Error]"===P(e)||e instanceof Error)}function C(e){return"function"==typeof e}function x(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function P(e){return Object.prototype.toString.call(e)}function A(e){return 10>e?"0"+e.toString(10):e.toString(10)}function U(){var e=new Date,t=[A(e.getHours()),A(e.getMinutes()),A(e.getSeconds())].join(":");return[e.getDate(),T[e.getMonth()],t].join(" ")}function H(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var R=/%[sdj%]/g;n.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,i=r.length,u=String(e).replace(R,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),a=r[n];i>n;a=r[++n])u+=y(a)||!k(a)?" "+a:" "+o(a);return u},n.deprecate=function(e,o){function i(){if(!u){if(t.throwDeprecation)throw new Error(o);t.traceDeprecation?console.trace(o):console.error(o),u=!0}return e.apply(this,arguments)}if(O(r.process))return function(){return n.deprecate(e,o).apply(this,arguments)};if(t.noDeprecation===!0)return e;var u=!1;return i};var S,W={};n.debuglog=function(e){if(O(S)&&(S=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!W[e])if(new RegExp("\\b"+e+"\\b","i").test(S)){var r=t.pid;W[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else W[e]=function(){};return W[e]},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=h,n.isBoolean=g,n.isNull=y,n.isNullOrUndefined=d,n.isNumber=b,n.isString=m,n.isSymbol=w,n.isUndefined=O,n.isRegExp=E,n.isObject=k,n.isDate=_,n.isError=j,n.isFunction=C,n.isPrimitive=x,n.isBuffer=e("./support/isBuffer");var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",U(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!k(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":8,_process:7,inherits:6}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("utils"),s=e("console"),c=e("Pollymer"),l=e("ResourceHandling/Aspect"),f=e("EngineUnits/Changes/ChangesResource"),p=e("utils.parseLinkHeader"),v=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.started=!1}return o(t,e),i(t,[{key:"start",value:function(){var e=this,n=new c.Request;n.on("finished",function(r,o,i){var u=e.parseHeaders(i,e._resourceHandler.uri);if(r>=200&&300>r){if(300>r)for(var a=0;a<o.length;++a)o[a].deleted?e._resourceHandler.trigger("child-deleted",e._resourceHandler,o[a]):e._resourceHandler.trigger("child-added",e._resourceHandler,o[a]);if(u.changesWaitUri){var c=e._resourceHandler.resourceHandlerFactory.engine;c.addResourceHandler(e._resourceHandler,t.InterestType,function(){return new f(e._resourceHandler.uri,u.changesWaitUri)}),e.started||(e.started=!0,e._resourceHandler.triggerOnceOnlyEvent("ready",e._resourceHandler)),n=null}else s.info("no changes-wait link")}else r>=400&&n.retry()}),n.start("HEAD",this._resourceHandler.uri)}},{key:"parseHeaders",value:function(e,t){var n=null;a.forEachOwnKeyValue(e,function(e,r){var o=e.toLowerCase();if("link"==o){var i=p(r);i&&i["changes-wait"]&&(n=a.toAbsoluteUri(t,i["changes-wait"].href))}});var r={};return n&&(s.info("changes-wait: ["+n+"]"),r.changesWaitUri=n),r}}],[{key:"InterestType",get:function(){return"changes"}},{key:"Events",get:function(){return["child-added","child-removed"]}}]),t}(l);t.exports=v},{"EngineUnits/Changes/ChangesResource":12,Pollymer:1,"ResourceHandling/Aspect":29,console:4,utils:37,"utils.parseLinkHeader":39}],11:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("utils"),s=e("Engine/EngineUnit"),c=e("EngineUnits/Changes/ChangesWaitConnectionsMap"),l=(e("EngineUnits/Changes/ChangesResource"),function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this._changesWaitConnectionsMap=new c(this)}return o(t,e),i(t,[{key:"update",value:function(){var e={};a.forEachOwnKeyValue(this._resources,function(t,n){n.changesWaitUri&&(e[n.changesWaitUri]=n)});var t={};a.forEachOwnKeyValue(e,function(e,n){t[e]={endpointUri:e,item:n}}),this._changesWaitConnectionsMap.adjustEndpoints(t)}},{key:"InterestType",get:function(){return"changes"}}]),t}(s));t.exports=l},{"EngineUnits/Changes/ChangesResource":12,"EngineUnits/Changes/ChangesWaitConnectionsMap":14,"Engine/EngineUnit":28,utils:37}],12:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("utils"),s=e("utils.parseLinkHeader"),c=e("Engine/EngineResource"),l=function(e){function t(e,n){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.changesWaitUri=n}return o(t,e),i(t,[{key:"updateItem",value:function(e,t){var n=this;a.forEachOwnKeyValue(e,function(e,t){var r=e.toLowerCase();if("link"==r){var o=s(t);if(o&&o["changes-wait"])return n.changesWaitUri=o["changes-wait"].href,!1}});for(var r=0;r<this.owners.length;r++)for(var o=this.owners[r],i=0;i<t.length;++i)t[i].deleted?o.trigger("child-deleted",o,t[i]):o.trigger("child-added",o,t[i])}}]),t}(c);t.exports=l},{"Engine/EngineResource":27,utils:37,"utils.parseLinkHeader":39}],13:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=(e("utils"),e("console")),s=(e("utils.parseLinkHeader"),e("Pollymer")),c=e("Engine/Connection"),l=function(e){function t(e,n){var o=this;r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.uri=n.endpointUri,this.request=new s.Request,this.res=n.item,this.isActive=!1,this.request.on("finished",function(e,t,n){o.isActive=!1,e>=200&&300>e&&o.res.updateItem(n,t),o._engine.update()})}return o(t,e),i(t,[{key:"hasChanged",value:function(e){return this.res.uri!=e.item.uri}},{key:"abort",value:function(){this.request.abort()}},{key:"refresh",value:function(e){if(!this.isActive){var t=this.uri;a.info("Changes Wait Request URI: "+t),this.request.start("GET",t,{Wait:55}),this.isActive=!0}}}]),t}(c);t.exports=l},{"Engine/Connection":24,Pollymer:1,console:4,utils:37,"utils.parseLinkHeader":39}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("Engine/ConnectionsMap"),s=e("EngineUnits/Changes/ChangesWaitConnection"),c=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return o(t,e),i(t,[{key:"newConnection",value:function(e,t){return new s(e,t)}},{key:"label",get:function(){return"Changes Wait"}}]),t}(a);t.exports=c},{"EngineUnits/Changes/ChangesWaitConnection":13,"Engine/ConnectionsMap":25}],15:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("utils"),s=e("console"),c=e("Pollymer"),l=e("EngineUnits/Value/ValueResource"),f=e("Engine/Connection"),p=function(e){function t(e,n,o){var i=this;r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.uri=n.endpointUri,this.request=new c.Request,this.resItems=n.items.slice(),this.isActive=!1,this.request.on("finished",function(e,t,n){i.isActive=!1,e>=200&&300>e&&a.forEachOwnKeyValue(t,function(e,t){s.info("got data for uri: "+e);var n=a.toAbsoluteUri(i.uri,e);l.updateValueItemMultiplex(o._resources,n,t.headers,t.body)}),i._engine.update()})}return o(t,e),i(t,[{key:"hasChanged",value:function(e){var t=!1;if(e.items.length!=this.resItems.length)t=!0;else{var n,r=[];for(n=0;n<e.items.length;n++)r.push(e.items[n].uri);r.sort();var o=[];for(n=0;n<this.resItems.length;n++)o.push(this.resItems[n].uri);for(o.sort(),n=0;n<r.length;n++)if(r[n]!=o[n]){t=!0;break}}return t}},{key:"abort",value:function(){this.request.abort()}},{key:"refresh",value:function(e){if(!this.isActive){for(var t=[],n=0;n<this.resItems.length;n++){var r=this.resItems[n],o=r.uri;t.push("u="+encodeURIComponent(o)+"&inm="+encodeURIComponent(r.etag))}var i=this.uri+"?"+t.join("&");s.info("Multiplex Wait Request URI: "+i),this.request.start("GET",i,{Wait:55}),this.isActive=!0}}}]),t}(f);t.exports=p},{"EngineUnits/Value/ValueResource":20,"Engine/Connection":24,Pollymer:1,console:4,utils:37}],16:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("Engine/ConnectionsMap"),s=e("EngineUnits/Value/MultiplexWaitConnection"),c=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return o(t,e),i(t,[{key:"newConnection",value:function(e,t){return new s(e,t,this._engineUnit)}},{key:"label",get:function(){return"Multiplex Wait"}}]),t}(a);t.exports=c},{"EngineUnits/Value/MultiplexWaitConnection":15,"Engine/ConnectionsMap":25}],17:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("utils"),s=e("console"),c=e("utils.mapWebSocketUrls"),l=e("WebSockHop"),f=e("Engine/Connection"),p=e("EngineUnits/Value/ValueResource"),v=function(e){function t(e,n,o){var i=this;r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var s=n.endpointUri;this.uri=s,this.socket=new l(s),this.subscribedItems={},this.isConnected=!1,this.isRetrying=!1,this.socket.formatter=new l.JsonFormatter,this.socket.on("opened",function(){i.socket.on("message",function(e){var t=e.uri,n=a.toAbsoluteUri(s,t),r=c.mapWebSocketUrlToHttpUrl(n);p.updateValueItemMultiplex(o._resources,r,e.headers,e.body)}),i.subscribedItems={},i.isConnected=!0,i.isRetrying=!1,i._engine.update()}),this.socket.on("closed",function(){i.isConnected=!1,i.isRetrying=!1}),this.socket.on("error",function(){i.isConnected=!1,i.isRetrying=!0})}return o(t,e),i(t,[{key:"subscribe",value:function(e){var t="subscribe",n="value";this.socket.request({type:t,mode:n,uri:e},function(t){"subscribed"==t.type&&(connection.subscribedItems[e]=e)})}},{key:"unsubscribe",value:function(e){var t="unsubscribe",n="value";this.socket.request({type:t,mode:n,uri:e},function(t){"unsubscribed"==t.type&&delete connection.subscribedItems[e]})}},{key:"mapToHttpUri",value:function(e){var t=a.toAbsoluteUri(this.uri,e);return c.mapWebSocketUrlToHttpUrl(t)}},{key:"checkSubscriptions",value:function(e){var t=this,n=this.uri;s.info("Multiplex WebSocket Request URI: "+n);var r={};a.forEachOwnKeyValue(this.subscribedItems,function(e,t){r[e]=t});for(var o=0;o<e.length;o++){var i=this.mapToHttpUri(e[o].uri);i in r?delete r[i]:this.subscribe(i)}a.forEachOwnKeyValue(r,function(e){t.unsubscribe(e)})}},{key:"close",value:function(){this.isConnected?this.socket.close():this.socket.abort()}},{key:"hasChanged",value:function(e){return 0==e.items.length}},{key:"abort",value:function(){this.socket.abort()}},{key:"refresh",value:function(e){this.isConnected&&this.checkSubscriptions(e.items)}}]),t}(f);t.exports=v},{"EngineUnits/Value/ValueResource":20,"Engine/Connection":24,WebSockHop:2,console:4,utils:37,"utils.mapWebSocketUrls":38}],18:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("Engine/ConnectionsMap"),s=e("EngineUnits/Value/MultiplexWebSocketConnection"),c=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return o(t,e),i(t,[{key:"newConnection",value:function(e,t){return new s(e,t,this._engineUnit)}},{key:"label",get:function(){return"Multiplex Web Socket"}}]),t}(a);t.exports=c},{"EngineUnits/Value/MultiplexWebSocketConnection":17,"Engine/ConnectionsMap":25}],19:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("utils"),s=e("Engine/EngineUnit"),c=(e("EngineUnits/Value/ValueResource"),e("EngineUnits/Value/ValueWaitConnectionsMap")),l=e("EngineUnits/Value/MultiplexWebSocketConnectionsMap"),f=e("EngineUnits/Value/MultiplexWaitConnectionsMap"),p=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this._valueWaitConnectionsMap=new c(this),this._multiplexWebSocketConnectionsMap=new l(this),this._multiplexWaitConnectionsMap=new f(this)}return o(t,e),
i(t,[{key:"update",value:function(){var e={},t={},n={};a.forEachOwnKeyValue(this._resources,function(r,o){if(o.multiplexWebSocketUri){var i=a.getOrCreateKey(t,o.multiplexWebSocketUri,function(){return{items:[]}});i.items.push(o)}else if(o.multiplexWaitUri){var u=a.getOrCreateKey(n,o.multiplexWaitUri,function(){return{items:[]}});u.items.push(o)}else e[o.valueWaitUri]=o});var r={},o={},i={};a.forEachOwnKeyValue(t,function(e,t){o[e]={endpointUri:e,items:t.items}}),a.forEachOwnKeyValue(n,function(t,n){n.items.length>1||!n.items[0].valueWaitUri?i[t]={endpointUri:t,items:n.items}:e[n.items[0].valueWaitUri]=n.items[0]}),a.forEachOwnKeyValue(e,function(e,t){r[e]={endpointUri:e,item:t}}),this._valueWaitConnectionsMap.adjustEndpoints(r),this._multiplexWebSocketConnectionsMap.adjustEndpoints(o),this._multiplexWaitConnectionsMap.adjustEndpoints(i)}},{key:"InterestType",get:function(){return"value"}}]),t}(s);t.exports=p},{"EngineUnits/Value/MultiplexWaitConnectionsMap":16,"EngineUnits/Value/MultiplexWebSocketConnectionsMap":18,"EngineUnits/Value/ValueResource":20,"EngineUnits/Value/ValueWaitConnectionsMap":22,"Engine/EngineUnit":28,utils:37}],20:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("utils"),s=(e("EngineUnits/Value/ValueEngineUnit"),e("Engine/EngineResource")),c=function(e){function t(e,n,o,i,a){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.etag=n,this.valueWaitUri=o,this.multiplexWaitUri=i,this.multiplexWebSocketUri=a}return o(t,e),i(t,[{key:"updateItem",value:function(e,t){var n=this;a.forEachOwnKeyValue(e,function(e,t){var r=e.toLocaleLowerCase();return"etag"==r?(n.etag=t,!1):void 0});for(var r=0;r<this.owners.length;r++){var o=this.owners[r];o.trigger("value",o,t)}}}],[{key:"updateValueItemMultiplex",value:function(e,t,n,r){a.forEachOwnKeyValue(e,function(e,o){e==t&&o.updateItem(n,r)})}}]),t}(s);t.exports=c},{"EngineUnits/Value/ValueEngineUnit":19,"Engine/EngineResource":27,utils:37}],21:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=(e("utils"),e("console")),s=(e("utils.parseLinkHeader"),e("Pollymer")),c=e("Engine/Connection"),l=function(e){function t(e,n){var o=this;r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.uri=n.endpointUri,this.request=new s.Request,this.res=n.item,this.isActive=!1,this.request.on("finished",function(e,t,n){o.isActive=!1,e>=200&&300>e&&o.res.updateItem(n,t),o._engine.update()})}return o(t,e),i(t,[{key:"hasChanged",value:function(e){return this.res.uri!=e.item.uri}},{key:"abort",value:function(){this.request.abort()}},{key:"refresh",value:function(e){if(!this.isActive){var t=this.uri;a.info("Value Wait Request URI: "+t),this.request.start("GET",t,{"If-None-Match":this.res.etag,Wait:55}),this.isActive=!0}}}]),t}(c);t.exports=l},{"Engine/Connection":24,Pollymer:1,console:4,utils:37,"utils.parseLinkHeader":39}],22:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("Engine/ConnectionsMap"),s=e("EngineUnits/Value/ValueWaitConnection"),c=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return o(t,e),i(t,[{key:"newConnection",value:function(e,t){return new s(e,t)}},{key:"label",get:function(){return"Value Wait"}}]),t}(a);t.exports=c},{"EngineUnits/Value/ValueWaitConnection":21,"Engine/ConnectionsMap":25}],23:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,u=n;a=c=s=void 0,r=!1,null===o&&(o=Function.prototype);var a=Object.getOwnPropertyDescriptor(o,i);if(void 0!==a){if("value"in a)return a.value;var s=a.get;return void 0===s?void 0:s.call(u)}var c=Object.getPrototypeOf(o);if(null===c)return void 0;e=c,t=i,n=u,r=!0}},a=e("utils"),s=e("console"),c=e("Pollymer"),l=e("ResourceHandling/Aspect"),f=e("EngineUnits/Value/ValueResource"),p=e("utils.mapWebSocketUrls"),v=e("utils.parseLinkHeader"),h=function(e){function t(e){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return o(t,e),i(t,[{key:"start",value:function(){var e=this,n=new c.Request;n.on("finished",function(r,o,i){var u=e.parseHeaders(i,e._resourceHandler.uri);if(r>=200&&400>r){if(300>r&&e._resourceHandler.trigger("value",e._resourceHandler,o),u.etag){var a=e._resourceHandler.resourceHandlerFactory.engine;a.addResourceHandler(e._resourceHandler,t.InterestType,function(){return new f(e._resourceHandler.uri,u.etag,u.valueWaitUri,u.multiplexWaitUri,u.multiplexWsUri)})}else s.info("no etag");n=null}else r>=400&&(404==r?(e._resourceHandler.trigger("removed",e._resourceHandler),n=null):n.retry())}),n.start("GET",this._resourceHandler.uri)}},{key:"parseHeaders",value:function(e,t){var n=null,r=null,o=null,i=null;a.forEachOwnKeyValue(e,function(e,u){var s=e.toLowerCase();if("etag"==s)n=u;else if("link"==s){var c=v(u);c&&c["value-wait"]&&(r=a.toAbsoluteUri(t,c["value-wait"].href)),c&&c["multiplex-wait"]&&(o=a.toAbsoluteUri(t,c["multiplex-wait"].href)),c&&c["multiplex-ws"]&&(i=p.mapHttpUrlToWebSocketUrl(a.toAbsoluteUri(t,c["multiplex-ws"].href)))}});var u={};return n&&(s.info("etag: ["+n+"]"),u.etag=n),r&&(s.info("value-wait: ["+r+"]"),u.valueWaitUri=r),o&&(s.info("multiplex-wait: ["+o+"]"),u.multiplexWaitUri=o),i&&(s.info("multiplex-ws: ["+i+"]"),u.multiplexWsUri=i),u}}],[{key:"InterestType",get:function(){return"value"}},{key:"Events",get:function(){return["value","removed"]}}]),t}(l);t.exports=h},{"EngineUnits/Value/ValueResource":20,Pollymer:1,"ResourceHandling/Aspect":29,console:4,utils:37,"utils.mapWebSocketUrls":38,"utils.parseLinkHeader":39}],24:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){r(this,e),this._engine=t}return o(e,[{key:"hasChanged",value:function(e){throw!1}},{key:"abort",value:function(){}},{key:"refresh",value:function(e){}}]),e}();t.exports=i},{}],25:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("utils"),u=e("console"),a=function(){function e(t){r(this,e),this._engineUnit=t,this._connections={}}return o(e,[{key:"adjustEndpoints",value:function(e){var t=this,n={};i.forEachOwnKeyValue(e,function(e,t){n[e]=t});var r=[];i.forEachOwnKeyValue(this._connections,function(t,o){delete n[t];var i=!1;if(t in e){var u=e[t];i=o.hasChanged(u)}else i=!0;i&&r.push(t)});for(var o=0;o<r.length;o++){var a=r[o];u.info("Remove '"+this.label+"' endpoint - '"+a+"'.");var s=this._connections[a];s.abort(),delete this._connections[a]}i.forEachOwnKeyValue(n,function(e,n){u.info("Adding '"+t.label+"' endpoint - '"+e+"'."),t._connections[e]=t.newConnection(t._engineUnit.engine,n)}),i.forEachOwnKeyValue(this._connections,function(t,n){var r=e[t];n.refresh(r)})}},{key:"newConnection",value:function(e,t){throw"unsupported"}},{key:"label",get:function(){throw"unsupported"}}]),e}();t.exports=a},{console:4,utils:37}],26:[function(e,t,n){(function(n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=(e("utils"),e("console")),u=(e("utils.mapWebSocketUrls"),function(){function e(){r(this,e),this._engineUnits=[],this._updatePending=!1}return o(e,[{key:"update",value:function(){var e=this;this._updatePending||(this._updatePending=!0,n.nextTick(function(){e._updatePending=!1,i.info("engine: setup long polls");for(var t=0;t<e._engineUnits.length;t++){var n=e._engineUnits[t];n.update()}}))}},{key:"addResourceHandler",value:function(e,t,n){for(var r=0;r<this._engineUnits.length;r++){var o=this._engineUnits[r];if(o.InterestType==t){o.addResourceHandler(e,n),this.update();break}}}},{key:"addEngineUnit",value:function(e){this._engineUnits.push(e),e.engine=this}}]),e}());t.exports=u}).call(this,e("_process"))},{_process:7,console:4,utils:37,"utils.mapWebSocketUrls":38}],27:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function i(e){r(this,i),this.uri=e,this.owners=[]};t.exports=o},{}],28:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("utils"),u=function(){function e(){r(this,e),this.engine=null,this._resources={}}return o(e,[{key:"update",value:function(){}},{key:"addResourceHandler",value:function(e,t){var n=i.getOrCreateKey(this._resources,e.uri,t);return n.owners.push(e),n}},{key:"InterestType",get:function(){return null}}]),e}();t.exports=u},{utils:37}],29:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function i(e){r(this,i),this._resourceHandler=e};t.exports=o},{}],30:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("utils"),u=(e("console"),function(){function e(){r(this,e),this._events={}}return o(e,[{key:"_getHandlersForType",value:function(e){return e in this._events||(this._events[e]=[]),this._events[e]}},{key:"on",value:function(e,t){var n=this._getHandlersForType(e);n.push(t)}},{key:"off",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(null!=t){var n=this._getHandlersForType(e);i.removeFromArray(n,t)}else delete this._events[e]}},{key:"trigger",value:function(e,t){for(var n=this._getHandlersForType(e).slice(),r=arguments.length,o=Array(r>2?r-2:0),i=2;r>i;i++)o[i-2]=arguments[i];for(var u=0,a=n.length;a>u;u++){var s=n[u];s.apply(t,o)}}}]),e}());t.exports=u},{console:4,utils:37}],31:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("utils"),u=e("utils.getWindowLocationHref"),a=e("ResourceHandling/Events"),s=function(){function e(t,n){r(this,e),this._events=new a;var o=u(),s=i.toAbsoluteUri(o,n);this._resourceHandler=t.getHandlerForUri(s),this._resourceHandler.addLiveResource(this)}return o(e,[{key:"on",value:function(e,t){this._events.on(e,t),this._resourceHandler.addEvent(e)}},{key:"off",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];this._events.off(e,t)}},{key:"cancel",value:function(){this._events=null,null!=this._resourceHandler&&(this._resourceHandler.removeLiveResource(this),this._resourceHandler=null)}}]),e}();t.exports=s},{"ResourceHandling/Events":30,utils:37,"utils.getWindowLocationHref":36}],32:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("ResourceHandling/LiveResource"),u=function(){function e(t){r(this,e),this.resourceHandlerFactory=t}return o(e,[{key:"getLiveResourceClass",value:function(){var e=this;return function(){function t(n){return r(this,t),new i(e.resourceHandlerFactory,n)}return t}()}}]),e}();t.exports=u},{"ResourceHandling/LiveResource":31}],33:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("utils"),a=e("console"),s=function(){function e(t,n){o(this,e),this.resourceHandlerFactory=t,this.uri=n,this._aspects={},this._liveResources=[],this._onceOnlyEventMap=new WeakMap,this._onceOnlyEvents=new Map}return i(e,[{key:"addLiveResource",value:function(e){this._liveResources.push(e),this._onceOnlyEventMap.set(e,[])}},{key:"removeLiveResource",value:function(e){u.removeFromArray(this._liveResources,e)}},{key:"trigger",value:function(e,t){for(var n=this._liveResources.length,r=arguments.length,o=Array(r>2?r-2:0),i=2;r>i;i++)o[i-2]=arguments[i];for(var u=0;n>u;u++){var a,s=this._liveResources[u];(a=s._events).trigger.apply(a,[e,t].concat(o))}}},{key:"triggerOnceOnlyEvent",value:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;n>o;o++)r[o-2]=arguments[o];this._onceOnlyEvents.set(e,{target:t,args:r}),this.checkOnceOnlyEvents()}},{key:"checkOnceOnlyEvents",value:function(){a.log("Checking once only events...");var e=!0,t=!1,n=void 0;try{for(var o,i=this._onceOnlyEvents.keys()[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var u=o.value,s=this._onceOnlyEvents.get(u),c=s.target,l=s.args,f=!0,p=!1,v=void 0;try{for(var h,g=this._liveResources[Symbol.iterator]();!(f=(h=g.next()).done);f=!0){var y=h.value,d=this._onceOnlyEventMap.get(y);if(d.indexOf(u)<0){var b;d.push(u),(b=y._events).trigger.apply(b,[u,c].concat(r(l)))}}}catch(m){p=!0,v=m}finally{try{!f&&g["return"]&&g["return"]()}finally{if(p)throw v}}}}catch(m){t=!0,n=m}finally{try{!e&&i["return"]&&i["return"]()}finally{if(t)throw n}}}},{key:"addEvent",value:function(e){var t=this.resourceHandlerFactory.findInterestTypeForEvent(e);if(!(t in this._aspects)){var n=this.resourceHandlerFactory.getAspectClass(t);if(null!=n){var r=new n(this);this._aspects[t]=r,r.start()}}this.checkOnceOnlyEvents()}}]),e}();t.exports=s},{console:4,utils:37}],34:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("utils"),u=e("ResourceHandling/ResourceHandler"),a=function(){function e(t){r(this,e),this.engine=t,this._resources={},this._aspectClasses={}}return o(e,[{key:"getHandlerForUri",value:function(e){var t=this;return i.getOrCreateKey(this._resources,e,function(){return new u(t,e)})}},{key:"addAspectClass",value:function(e){var t=e.InterestType;this._aspectClasses[t]=e}},{key:"getAspectClass",value:function(e){return this._aspectClasses[e]}},{key:"findInterestTypeForEvent",value:function(e){var t=null;return i.forEachOwnKeyValue(this._aspectClasses,function(n,r){return i.findInArray(r.Events,e)>=0?(t=n,!1):void 0}),t}}]),e}();t.exports=a},{"ResourceHandling/ResourceHandler":33,utils:37}],35:[function(e,t,n){"use strict";var r=e("Engine/Engine"),o=new r,i=e("EngineUnits/Value/ValueEngineUnit");o.addEngineUnit(new i);var u=e("EngineUnits/Changes/ChangesEngineUnit");o.addEngineUnit(new u);var a=e("ResourceHandling/ResourceHandlerFactory"),s=new a(o),c=e("EngineUnits/Value/ValueAspect");s.addAspectClass(c);var l=e("EngineUnits/Changes/ChangesAspect");s.addAspectClass(l);var f=e("ResourceHandling/LiveResourceFactory"),p=new f(s),v=p.getLiveResourceClass();t.exports=v},{"EngineUnits/Changes/ChangesAspect":10,"EngineUnits/Changes/ChangesEngineUnit":11,"EngineUnits/Value/ValueEngineUnit":19,"EngineUnits/Value/ValueAspect":23,"Engine/Engine":26,"ResourceHandling/LiveResourceFactory":32,"ResourceHandling/ResourceHandlerFactory":34}],36:[function(e,t,n){"use strict";var r=function(){return window.location.href};t.exports=r},{}],37:[function(e,t,n){"use strict";var r=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1},o=function(e,t){return!(r(e,t)<0)},i=function(e,t){for(var n=!0;n;){var r=utils.findInArray(e,t);-1!=r?e.splice(r,1):n=!1}},u=function(e){var t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null},a=function(e,t){function n(e){var t=[];return e.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(e){"/.."===e?t.pop():t.push(e)}),t.join("").replace(/^\//,"/"===e.charAt(0)?"/":"")}return t=u(t||""),e=u(e||""),t&&e?(t.protocol||e.protocol)+(t.protocol||t.authority?t.authority:e.authority)+n(t.protocol||t.authority||"/"===t.pathname.charAt(0)?t.pathname:t.pathname?(e.authority&&!e.pathname?"/":"")+e.pathname.slice(0,e.pathname.lastIndexOf("/")+1)+t.pathname:e.pathname)+(t.protocol||t.authority||t.pathname?t.search:t.search||e.search)+t.hash:null},s=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var r=t(n,e[n]);if("undefined"!=typeof r&&!r)break}},c=function(e,t,n){return t in e||(e[t]=n()),e[t]},l=function(e,t){return e.substring(0,t.length)==t},f=function(e,t,n){return n+e.substring(t.length)};t.exports={findInArray:r,isInArray:o,removeFromArray:i,toAbsoluteUri:a,forEachOwnKeyValue:s,getOrCreateKey:c,beginsWith:l,replaceStart:f}},{}],38:[function(e,t,n){"use strict";var r=e("utils"),o=e("utils.getWindowLocationHref");t.exports={mapHttpUrlToWebSocketUrl:function(e){var t=o(),n=r.toAbsoluteUri(t,e),i=n;if(r.beginsWith(n,"http://")?i=r.replaceStart(n,"http://","ws://"):r.beginsWith(n,"https://")&&(i=r.replaceStart(n,"https://","wss://")),!r.beginsWith(i,"ws://")&&!r.beginsWith(i,"wss://"))throw"not valid";return i},mapWebSocketUrlToHttpUrl:function(e){var t=e;if(r.beginsWith(e,"ws://")?t=r.replaceStart(e,"ws://","http://"):r.beginsWith(e,"wss://")&&(t=r.replaceStart(e,"wss://","https://")),!r.beginsWith(t,"http://")&&!r.beginsWith(t,"https://"))throw"not valid";return t}}},{utils:37,"utils.getWindowLocationHref":36}],39:[function(e,t,n){"use strict";var r=e("console");t.exports=function(e){if(0==e.length)return null;for(var t={},n=0,o=!0;o;){for(;n<e.length&&" "==e[n];++n);if(n>=e.length||"<"!=e[n])return null;var i=n+1,u=e.indexOf(">",n);if(-1==u)return null;var a=e.substring(i,u);n=u+1,o=!1;var s=!1;if(n<e.length)if(","==e[n])o=!0,++n;else{if(";"!=e[n])return null;s=!0,++n}for(var c=null,l={};s;){for(;n<e.length&&" "==e[n];++n);if(n>=e.length)return null;for(i=n;n<e.length&&("="!=e[n]&&","!=e[n]&&";"!=e[n]);++n);u=n;var f=e.substring(i,u),p=null;if(n<e.length&&"="==e[n])if(++n,n<e.length&&'"'==e[n]){if(i=n+1,n=e.indexOf('"',i),-1==n)return null;u=n,p=e.substring(i,u),++n}else{for(i=n;n<e.length&&(","!=e[n]&&";"!=e[n]);++n);u=n,p=e.substring(i,u)}if(s=!1,n<e.length)if(","==e[n])o=!0,++n;else{if(";"!=e[n])return null;s=!0,++n}"rel"==f?c=p:l[f]=p}if(c)for(var v=c.split(" "),h=0;h<v.length;++h){r.info("link: url=["+a+"], rel=["+v[h]+"]");var g={};g.rel=v[h],g.href=a;for(var y in l)l.hasOwnProperty(y)&&(g[y]=l[y]);t[g.rel]=g}}return t}},{console:4}]},{},[35])(35)});